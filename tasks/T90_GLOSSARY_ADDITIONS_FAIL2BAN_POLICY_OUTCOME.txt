================================================================================
T90_GLOSSARY_ADDITIONS_FAIL2BAN_POLICY_OUTCOME.txt
Version: v0.1.0 (ENTWURF)
Status: ENTWURF (Copy/Paste ins Glossar)
================================================================================

## 1) Zweck
Dieses Dokument liefert die neuen Glossar-Begriffe aus Phase 3 (Fail2ban/Policy Outcomes),
als Copy/Paste-ready Einträge.

## 2) Glossar-Additions (Copy/Paste)
- F2B_EVENT
  Kanonische, maschinenlesbare Logzeile (key=value) für Fail2ban.
  Enthält mindestens: Class, SrcIP, User, Reason, Detail.

- F2B_CLASS
  Kanonische Event-Klasse für Fail2ban-Entscheidungen.
  Werte: UNKNOWN_USER | KNOWN_BADPASS | BACKEND_ERROR | POLICY_DENY

- SrcIP
  Die vom Client stammende WAN-Quelle für Fail2ban (aus Calling-Station-Id).
  Fallback: NA (darf niemals Fail2ban matchen).

- Calling-Station-Id (RADIUS Attr 31)
  RADIUS Attribut, das die WAN-IP (oder Identifier) des anfragenden Clients trägt.
  Wird als SrcIP für Fail2ban verwendet.

- Tmp-String Reservation
  FreeRADIUS Control-Attribute, die exklusiv für die Event-Klassifikation reserviert sind:
  &control:Tmp-String-0 = F2B_CLASS
  &control:Tmp-String-1 = AUTH_DETAIL

- AUTH_DETAIL
  Interner Detail-Flag zur deterministischen Auth-Fehlererkennung (z.B. MSCHAP_FAIL).

- POLICY_OUTCOME
  Ergebnis einer Policy-Entscheidung für den VPN-Zugang:
  DENY (Reject) | RESTRICT (Accept + Walled Garden) | OK (Accept + Full Tunnel)

- POLICY_DENY
  Policy-Outcome: DENY (Reject), Tunnel wird nicht aufgebaut.
  Darf niemals Fail2ban triggern (NAT-Safety).

- POLICY_RESTRICT
  Policy-Outcome: RESTRICT (Accept), Tunnel steht, aber Walled Garden / Restricted Mode greift.

- R_ Reason-Codes
  Kanonische Policy-Gründe als Code, z.B. R_ACCOUNT_BANNED, R_QUOTA_EXCEEDED, R_CLAIM_REQUIRED.
  Dienen der Observability/Support und sind deterministisch priorisiert.

- R_AUTH_ Reason-Codes
  Auth-/Infra-Gründe als Code, z.B. R_AUTH_BACKEND_SQL_DOWN, R_AUTH_UNKNOWN_USER, R_AUTH_BADPASS.
  Dienen der sauberen Trennung von Policy vs. Auth-Failure.

- D1a (SQL First / Fail-Closed)
  Sicherheitsregel: Wenn SQL/Backend nicht verfügbar ist, darf keine VPN-Session entstehen.
  Ergebnis: Reject ohne Fail2ban-Ban-Storm.

- NAT-Safety
  Sicherheitsziel: Fail2ban darf legitime Nutzer hinter NAT nicht kollektiv aussperren.
  Daraus folgt: Bans nur für UNKNOWN_USER und KNOWN_BADPASS; niemals für POLICY_DENY/BACKEND_ERROR.

================================================================================
Changelog:
- v0.1.0 (ENTWURF): Glossar-Additions für Fail2ban/Policy Outcome/R_ und R_AUTH_ Begriffe.
================================================================================